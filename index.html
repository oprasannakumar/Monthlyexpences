<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Monthly Expenses</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    form {
      background: #ffffff;
      padding: 20px;
      border-radius: 8px;
      max-width: 400px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input, select, button {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
    }
    button {
      margin-top: 15px;
      background: #007bff;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 16px;
    }
    button:hover {
      background: #0056b3;
    }
  </style>
</head>

<body>

<form id="expenseForm">

  <h2>Monthly Expense</h2>

  <label>Date</label>
  <input type="date" id="date" required>

  <label>Narration</label>
  <input type="text" id="narration" placeholder="Description" required>

    <label>Transaction Flow</label>
  <select id="From/to" required>
    <option value="">Select</option>
    <option value="Deposit">Deposit</option>
    <option value="Withdraw">Withdraw</option>
  </select>

  <label>Transaction Type</label>
  <select id="trtype" required>
    <option value="">Select</option>
    <option value="cash">Cash</option>
    <option value="upi">UPI</option>
    <option value="net">Net Banking</option>
    <option value="debit">Debit</option>
    <option value="credit">Credit</option>
  </select>

  <label id="fromToLabel" style="display:none;">From / To</label>
  <select id="from_to" style="display:none;"></select>

  <label>Amount</label>
  <input type="number" id="amount" required>

  <button type="submit">Submit</button>

</form>

<script>
  const trtype = document.getElementById("trtype");
  const fromTo = document.getElementById("from_to");
  const fromToLabel = document.getElementById("fromToLabel");

  const bankAccounts = [
    "Axis",
    "HDFC Old",
    "HDFC New",
    "ICICI",
    "IndusInd",
    "Kotak",
    "RBL",
    "SBI"
  ];

  const creditCards = [
    "Axis Flipkart",
    "MyZone",
    "HDFC Millennia"
  ];

  trtype.addEventListener("change", () => {
    fromTo.innerHTML = "";

    if (trtype.value === "cash") {
      fromTo.style.display = "none";
      fromToLabel.style.display = "none";
      fromTo.required = false;
      fromTo.value = "Cash";
      return;
    }

    fromTo.style.display = "block";
    fromToLabel.style.display = "block";
    fromTo.required = true;

    let options = [];

    if (["upi", "net", "debit"].includes(trtype.value)) {
      options = bankAccounts;
    }

    if (trtype.value === "credit") {
      options = creditCards;
    }

    const defaultOption = document.createElement("option");
    defaultOption.value = "";
    defaultOption.text = "Select";
    fromTo.appendChild(defaultOption);

    options.forEach(opt => {
      const option = document.createElement("option");
      option.value = opt;
      option.text = opt;
      fromTo.appendChild(option);
    });
  });

  document.getElementById("expenseForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const data = {
      date: document.getElementById("date").value,
      narration: document.getElementById("narration").value,
      trtype: trtype.value,
      from_to: trtype.value === "cash" ? "Cash" : fromTo.value,
      amount: document.getElementById("amount").value
    };

    console.log("Submitting:", data);

    try {
      await fetch("https://YOUR_N8N_DOMAIN/webhook/monthly-expenses", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      alert("✅ Expense saved successfully");
      document.getElementById("expenseForm").reset();
      fromTo.style.display = "none";
      fromToLabel.style.display = "none";

    } catch (err) {
      alert("❌ Error sending data");
      console.error(err);
    }
  });
</script>

</body>
</html>

